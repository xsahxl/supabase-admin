# 需求分析文档

## 1. 项目概述

### 1.1 项目背景
开发一个基于 Supabase 的企业管理系统，为企业和运营人员提供完整的管理平台。

### 1.2 项目目标
- 为企业用户提供便捷的企业信息管理平台
- 为运营人员提供高效的企业审核和管理工具
- 建立完整的审核流程和数据安全机制

## 2. 系统架构

### 2.1 整体架构
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   企业后台      │    │   Admin后台     │    │   Supabase      │
│   (Next.js)     │◄──►│   (Next.js)     │◄──►│   (后端服务)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 2.2 技术选型
- **后端**: Supabase (PostgreSQL + Auth + Real-time)
- **前端**: Next.js 14 + TypeScript + TailwindCSS
- **状态管理**: Zustand
- **表单处理**: React Hook Form
- **部署**: Vercel

## 3. 功能需求

### 3.1 企业后台管理系统

#### 3.1.1 用户管理
- **注册功能**
  - 支持邮箱注册
  - 邮箱验证
  - 密码强度要求
  - 用户协议确认

- **登录功能**
  - 邮箱/密码登录
  - 记住登录状态
  - 忘记密码功能
  - 登录日志记录

- **用户信息管理**
  - 个人信息编辑
  - 密码修改
  - 头像上传
  - 登录设备管理

#### 3.1.2 企业信息管理
- **企业基本信息**
  - 企业名称
  - 企业类型
  - 成立时间
  - 注册资本
  - 经营范围
  - 企业地址
  - 联系电话
  - 企业邮箱
  - 企业网站
  - 企业简介

- **企业证件信息**
  - 营业执照
  - 组织机构代码证
  - 税务登记证
  - 其他相关证件

- **联系人信息**
  - 联系人姓名
  - 联系电话
  - 邮箱地址
  - 职位

#### 3.1.3 状态管理
- **企业状态**
  - 草稿 (Draft)
  - 待审核 (Pending)
  - 审核通过 (Approved)
  - 审核不通过 (Rejected)
  - 已下架 (Suspended)

- **状态流转**
  ```
  草稿 → 待审核 → 审核通过/审核不通过 → 已下架
  ```

#### 3.1.4 操作功能
- **草稿保存**
  - 自动保存
  - 手动保存
  - 草稿恢复

- **审核提交**
  - 信息完整性检查
  - 提交确认
  - 提交时间记录

- **信息查看**
  - 当前状态显示
  - 审核历史
  - 审核意见查看

### 3.2 Admin 运营后台

#### 3.2.1 用户管理
- **邀请系统**
  - 超级管理员邀请新用户
  - 邀请邮件发送
  - 邀请链接有效期管理
  - 邀请状态跟踪

- **用户权限管理**
  - 角色分配
  - 权限设置
  - 用户状态管理
  - 登录日志查看

#### 3.2.2 企业审核管理
- **企业列表**
  - 分页显示
  - 搜索筛选
  - 状态筛选
  - 排序功能

- **审核操作**
  - 审核通过
  - 审核不通过
  - 审核意见填写
  - 审核时间记录

- **审核历史**
  - 审核记录查看
  - 审核意见历史
  - 状态变更历史

#### 3.2.3 数据统计
- **企业统计**
  - 企业总数
  - 各状态企业数量
  - 新增企业趋势
  - 审核通过率

- **用户统计**
  - 注册用户数
  - 活跃用户数
  - 用户增长趋势

- **审核统计**
  - 审核工作量
  - 审核效率
  - 审核质量

## 4. 非功能需求

### 4.1 性能需求
- 页面加载时间 < 3秒
- 数据库查询响应时间 < 1秒
- 支持并发用户数 > 1000

### 4.2 安全需求
- 用户数据加密存储
- 传输数据加密 (HTTPS)
- 防止 SQL 注入
- 防止 XSS 攻击
- 防止 CSRF 攻击
- 操作日志记录

### 4.3 可用性需求
- 系统可用性 > 99.9%
- 数据备份策略
- 故障恢复机制
- 用户友好的错误提示

### 4.4 兼容性需求
- 支持主流浏览器 (Chrome, Firefox, Safari, Edge)
- 支持移动端访问
- 响应式设计

## 5. 业务流程

### 5.1 企业注册流程
```
1. 用户注册 → 2. 邮箱验证 → 3. 登录系统 → 4. 填写企业信息 → 5. 保存草稿/提交审核
```

### 5.2 企业审核流程
```
1. 企业提交审核 → 2. Admin查看待审核列表 → 3. 审核企业信息 → 4. 填写审核意见 → 5. 通过/不通过 → 6. 通知企业用户
```

### 5.3 Admin邀请流程
```
1. 超级管理员发送邀请 → 2. 用户接收邀请邮件 → 3. 点击邀请链接 → 4. 设置密码 → 5. 登录Admin后台
```

## 6. 数据需求

### 6.1 数据量估算
- 企业用户数: 预计 10,000+
- 企业信息: 每个企业约 1KB 数据
- 审核记录: 每个企业约 5-10 条记录
- Admin用户: 预计 50-100 人

### 6.2 数据备份
- 每日自动备份
- 备份数据保留 30 天
- 异地备份存储

## 7. 接口需求

### 7.1 外部接口
- 邮件服务 (SendGrid/SMTP)
- 短信服务 (可选)
- 文件存储 (Supabase Storage)

### 7.2 第三方集成
- 企业信息验证 API (可选)
- 地图服务 (可选)
- 支付服务 (可选)

## 8. 约束条件

### 8.1 技术约束
- 使用 Supabase 作为后端服务
- 前端使用 Next.js 框架
- 必须支持 TypeScript

### 8.2 业务约束
- 一个用户只能管理一个企业
- 企业信息必须经过审核才能生效
- Admin用户必须通过邀请才能注册

### 8.3 时间约束
- 第一阶段: 基础功能开发 (4周)
- 第二阶段: 高级功能开发 (2周)
- 第三阶段: 测试和优化 (2周)

## 9. 风险评估

### 9.1 技术风险
- Supabase 服务稳定性
- 数据安全风险
- 性能瓶颈

### 9.2 业务风险
- 用户接受度
- 审核效率问题
- 数据质量问题

### 9.3 缓解措施
- 选择稳定的云服务
- 实施完善的安全措施
- 建立监控和告警机制
- 制定应急预案 